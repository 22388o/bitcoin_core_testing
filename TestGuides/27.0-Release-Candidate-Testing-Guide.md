# Testing Guide: Bitcoin Core 27.0 Release Candidate

_For feedback on this guide, please visit [TBD Issue #](https://github.com/bitcoin/bitcoin/issues/TBD)_

This document outlines some of the upcoming Bitcoin Core 27.0 release changes and provides steps to help test them. This guide is meant to be the starting point for experimentation and further testing, but is in no way comprehensive! After running through the steps in this guide, you are encouraged to do your own testing.

This can be as simple as testing the same features in this guide but trying it a different way. Even better, think of features you use regularly and test that they still work as expected in the release candidate. You can also read the [release notes][release notes] to find something not covered in this guide. **This is a great way to be involved with Bitcoin's development and helps keep Bitcoin running smoothly and bug-minimized! Your help in this endeavor is greatly appreciated.**


## Overview

Changes covered in this testing guide include:

* [Mempool.dat v1/v2 compatibility](#mempooldat-v1v2-compatibility) ([#28207](https://github.com/bitcoin/bitcoin/pull/28207))
* [v2 Transport on by default](#v2-transport-on-by-default) ([#29347](https://github.com/bitcoin/bitcoin/pull/29347))
* [`-netinfo` backward compatibility with pre-v26 nodes](#netinfo-backward-compatibility-with-pre-v26-nodes) ([#29212](https://github.com/bitcoin/bitcoin/pull/29212))
* [v3 Transaction Policy](#v3-transaction-policy) ([#28948](https://github.com/bitcoin/bitcoin/pull/29347))
* [CoinGrinder coin selection algorithm](#coingrinder-coin-selection-algorithm)
  ([#27877](https://github.com/bitcoin/bitcoin/pull/27877))
* [`migratewallet` RPC is no longer experimental](#migratewallet-rpc-is-no-longer-experimental)
  ([#28037](https://github.com/bitcoin/bitcoin/pull/29347))

***

For a comprehensive list of changes in Bitcoin Core 27.0, check out the [release notes][release notes].

## Preparation
Choose a directory to work from, for example:
```bash
cd
export RC_TEST_DIR=~/rctesting
mkdir $RC_TEST_DIR
cd $RC_TEST_DIR
```

### 1. Obtain Latest Release Candidate

**Current Release Candidate:** [Bitcoin Core 27.0rc1][releases-page] ([release-notes][release notes])

There are two ways to grab the latest release candidate: source code or pre-compiled binary. Choose one of the two.

#### From Source
The source code for the release candidate can be obtained [from the releases page][releases-page] (and extracted), or by using git directly:
```bash
cd $RC_TEST_DIR
git clone https://github.com/bitcoin/bitcoin.git
cd bitcoin
git checkout tags/v27.0rc1
```
(ensure source is present in RC_TEST_DIR/bitcoin in either instance (run `mv` if necessary))

#### From Binary
If using a binary is preferred, make sure to [obtain the correct one for your system][binaries].
When working from binary, extract (example for x86_64):
```bash
cd $RC_TEST_DIR
wget https://bitcoincore.org/bin/bitcoin-core-27.0/test.rc1/bitcoin-27.0rc1-x86_64-linux-gnu.tar.gz
tar xf bitcoin-27.0rc1-x86_64-linux-gnu.tar.gz
```
(directory `RC_TEST_DIR/bitcoin-27.0rc1/` now exists)

[releases-page]: https://github.com/bitcoin/bitcoin/releases/tag/v27.0rc1
[binaries]: https://bitcoincore.org/bin/bitcoin-core-27.0/test.rc1/
[release notes]: https://github.com/bitcoin-core/bitcoin-devwiki/wiki/27.0-Release-Notes-Draft

### 2. Compile Release Candidate

**If testing v27 from binary (rather than building from source), skip this step**

Before compiling, make sure that your system has all the correct [dependencies][dependencies] installed.

For more information on compiling from source, here are some guides to compile Bitcoin Core for [UNIX/Linux](https://github.com/bitcoin/bitcoin/blob/master/doc/build-unix.md), [macOS](https://github.com/bitcoin/bitcoin/blob/master/doc/build-osx.md), [Windows](https://github.com/bitcoin/bitcoin/blob/master/doc/build-windows.md), [FreeBSD](https://github.com/bitcoin/bitcoin/blob/master/doc/build-freebsd.md), [NetBSD](https://github.com/bitcoin/bitcoin/blob/master/doc/build-netbsd.md), and [OpenBSD](https://github.com/bitcoin/bitcoin/blob/master/doc/build-openbsd.md).

[dependencies]: https://github.com/bitcoin/bitcoin/blob/master/doc/dependencies.md

### 3. Obtain Previous Releases

Some testing in this guide involves using previous releases, v26.0 and v25.1.

#### v26.0
Obtain the v26.0 binary from [here][binaries26] and extract within RC_TEST_DIR:
```bash
cd $RC_TEST_DIR
wget https://bitcoincore.org/bin/bitcoin-core-26.0/bitcoin-26.0-x86_64-linux-gnu.tar.gz
tar xf bitcoin-26.0-x86_64-linux-gnu.tar.gz
```
(directory `RC_TEST_DIR/bitcoin-26.0` now exists)

#### v25.1
Obtain the v25.1 binary from [here][binaries25] and extract within RC_TEST_DIR:
```bash
cd $RC_TEST_DIR
wget https://bitcoincore.org/bin/bitcoin-core-25.1/bitcoin-25.1-x86_64-linux-gnu.tar.gz
tar xf bitcoin-25.1-x86_64-linux-gnu.tar.gz
```
(directory `~/bitcoin-25.1` now exists)

[binaries26]: https://bitcoincore.org/bin/bitcoin-core-26.0/
[binaries25]: https://bitcoincore.org/bin/bitcoin-core-25.1/


### 4. Setting up command line environment

#### Create data directories

Create temporary data directories for each version.
```bash
export DATA_DIR_27=/tmp/27-rc-test
mkdir $DATA_DIR_27
export DATA_DIR_26=/tmp/26-test
mkdir $DATA_DIR_26
export DATA_DIR_25=/tmp/25-test
mkdir $DATA_DIR_25
```

#### Specify paths
Define paths containing binaries that will be executed.

##### v27 from Source
If testing with v27 compiled source, run:

```bash
export BINARY_PATH_27=$RC_TEST_DIR/bitcoin/src
```

##### v27 Pre-Compiled Binaries
If testing from v27 downloaded binaries, run:
```bash
export BINARY_PATH_27=$RC_TEST_DIR/bitcoin-27.0rc1/bin
```

##### Previous Releases
Specify the binary path for the v26.0 and v25.1 binaries.
```bash
export BINARY_PATH_26=$RC_TEST_DIR/bitcoin-26.0/bin
export BINARY_PATH_25=$RC_TEST_DIR/bitcoin-25.1/bin
```

#### Create Aliases
To avoid specifying the data directory (`-datadir=$DATA_DIR`) on each command, below are a few extra variables to set.

##### v27 Aliases
```bash
alias bitcoind-test="$(echo $BINARY_PATH_27)/bitcoind -datadir=$DATA_DIR_27"
alias bcli="$(echo $BINARY_PATH_27)/bitcoin-cli -datadir=$DATA_DIR_27"
```

##### Aliases for Previous Releases
```bash
alias bitcoind-test-26="$(echo $BINARY_PATH_26)/bitcoind -datadir=$DATA_DIR_26"
alias bcli26="$(echo $BINARY_PATH_26)/bitcoin-cli -datadir=$DATA_DIR_26"
alias bitcoind-test-25="$(echo $BINARY_PATH_25)/bitcoind -datadir=$DATA_DIR_25"
alias bcli25="$(echo $BINARY_PATH_25)/bitcoin-cli -datadir=$DATA_DIR_25"
```

##### Verify Aliases
Verify that all versions are correct (e.g. that there are no accidental duplicates)

```bash
bcli --version | grep version
bitcoind-test --version | grep version
bcli26 --version | grep version
bitcoind-test-26 --version | grep version
bcli25 --version | grep version
bitcoind-test-25 --version | grep version
```
Expected results:
```
Bitcoin Core RPC client version v27.0.0rc1
Bitcoin Core version v27.0.0rc1
Bitcoin Core RPC client version v26.0.0
Bitcoin Core version v26.0.0
Bitcoin Core RPC client version v25.1.0
Bitcoin Core version v25.1.0

```

#### Create Configuration Files
Prepare a basic bitcoin.conf file for each version.

##### v27
```bash
echo "regtest=1" > $DATA_DIR_27/bitcoin.conf
```

##### Previous Versions
For v26.0:
```bash
echo "regtest=1" > $DATA_DIR_26/bitcoin.conf
echo "[regtest]" >> $DATA_DIR_26/bitcoin.conf
echo "rpcallowip=127.0.0.1" >> $DATA_DIR_26/bitcoin.conf
echo "rpcbind=127.0.0.1:18343" >> $DATA_DIR_26/bitcoin.conf
echo "rpcport=18343" >> $DATA_DIR_26/bitcoin.conf
echo "bind=127.0.0.1:18344" >> $DATA_DIR_26/bitcoin.conf
echo "bind=127.0.0.1:18345=onion" >> $DATA_DIR_26/bitcoin.conf
```

For v25.1:
```bash
echo "regtest=1" > $DATA_DIR_25/bitcoin.conf
echo "[regtest]" >> $DATA_DIR_25/bitcoin.conf
echo "rpcallowip=127.0.0.1" >> $DATA_DIR_25/bitcoin.conf
echo "rpcbind=127.0.0.1:18243" >> $DATA_DIR_25/bitcoin.conf
echo "rpcport=18243" >> $DATA_DIR_25/bitcoin.conf
echo "bind=127.0.0.1:18244" >> $DATA_DIR_25/bitcoin.conf
echo "bind=127.0.0.1:18245=onion" >> $DATA_DIR_25/bitcoin.conf
```

#### Command Execution
Throughout the rest of the guide, command execution will look similar to the following:

When using RPC:
```
bcli [cli args]
```

Starting a node in the foreground:
```
bitcoind-test
```

Use `CTRL-C` to stop a node running in the foreground.

Perform a start and stop on each node (v27 and v26), and inspect the output for the correct version.

For the rest of the guide, bitcoind will be started in daemon mode (`-daemon`) and as such `CTRL-C` will not stop the process. Instead, use `bcli stop`.

### 5. Reset testing environment

Between sections in this guide, it's recommended to stop your node and wipe the data directories.

#### Stopping Nodes
```bash
bcli stop
bcli26 stop
bcli25 stop
```

#### Recreating Temporary Data Directories
```bash
rm -r $DATA_DIR_27
mkdir $DATA_DIR_27
rm -r $DATA_DIR_26
mkdir $DATA_DIR_26
rm -r $DATA_DIR_25
mkdir $DATA_DIR_25
```

Recreate the bitcoin.conf files as specified in [Create Configuration Files](#Create-Configuration-Files).

***

## mempool.dat v1/v2 compatibility
The `mempool.dat` file uses a new format (v2, enhancing integrity checking of `mempool.dat`), which isn't understood by previous versions of Bitcoin Core.  A temporary setting `-persistmempoolv1` allows fallback to the legacy format.

The following tests migration from the legacy v1 to the new v2 format.

Before proceeding [stop your nodes and clean the datadirs](#5-reset-testing-environment).

Start the v26 node, create a wallet, and fund it with 50 tBTC.
```bash
bitcoind-test-26 -daemon
bcli26 createwallet test
bcli26 -rpcwallet=test -generate 101
```

Expected results:
```
{
  "name": "test"
}
...
{
  "address": "bcrt1q...",
  "blocks": [
    "57d09495e62df6a4e51f5ebe517b11b1913d7e9ba6dccbbbf5f3989bb2b43b37",
...
    "659b4ed5400f14c3c901fa5646b40da3be8b9d526a03d9b5b6684fd99ce82c6e",
    "79cef426a1e3a909ebc238c85498cd05c15a79442df46e2d3017f3f84f3a881e"
  ]
}
```
(your block hashes will differ)

Create two transactions (a child and parent transaction) and add them to the mempool.
```bash
export ADDRESS=$(bcli26 -rpcwallet=test getnewaddress)
bcli26 -rpcwallet=test -named send outputs="{\"$ADDRESS\": 1}" fee_rate=10
bcli26 -rpcwallet=test -named send outputs="{\"$ADDRESS\": 1}" fee_rate=10
```

Expected results:
txids specified for each transaction.
```
{
  "txid": "2fdc4aa2755f29d4ba8104f31e488b3e5df814a360ddb0b97ebc273a125a5971",
  "complete": true
}
...
{
  "txid": "28b8215819e7bc428787fc5e71c3927e20ad13c1a60d79ee1a409acded6efda3",
  "complete": true
}
```

Stop the v26 node (saving the mempool).
```bash
bcli26 stop
```

Copy the v26 data into the v27 datadir and restore the v27 config.
```bash
mv $DATA_DIR_27/bitcoin.conf $DATA_DIR_27/bitcoin.conf.backup
cp -r $DATA_DIR_26/* $DATA_DIR_27/
mv $DATA_DIR_27/bitcoin.conf.backup $DATA_DIR_27/bitcoin.conf
```

Start the v27 node with the new `persistmempoolv1` parameter.
```bash
bitcoind-test -daemon -persistmempoolv1=1
```

View the contents of the mempool.
Verify that the mempool contains the same two transactions created earlier.
```bash
bcli getmempoolinfo
bcli getrawmempool
```

```
{
  "loaded": true,
  "size": 2,
  "bytes": 282,
  "usage": 2416,
  "total_fee": 0.00002820,
  "maxmempool": 300000000,
  "mempoolminfee": 0.00001000,
  "minrelaytxfee": 0.00001000,
  "incrementalrelayfee": 0.00001000,
  "unbroadcastcount": 2,
  "fullrbf": false
}
...
[
  "2fdc4aa2755f29d4ba8104f31e488b3e5df814a360ddb0b97ebc273a125a5971",
  "28b8215819e7bc428787fc5e71c3927e20ad13c1a60d79ee1a409acded6efda3"
]
```

Stop the node and verify use of the legacy v1 format.
```bash
bcli stop
ls --full-time $DATA_DIR_27/regtest/mempool.dat
hexdump -n8 $DATA_DIR_27/regtest/mempool.dat
```
Take note of the modified date.

Expected results:
```
-rw------- 1 dev dev 558 2024-03-17 18:18:13.224229360 -0400 /tmp/27-rc-test/regtest/mempool.dat
...
0000000 0001 0000 0000 0000                    
0000008
```

Start the node using the new mempool.dat format (by omitting `-persistmempoolv1=1`).
Verify that the mempool contains the same two transactions created earlier.
```bash
bitcoind-test -daemon
bcli getmempoolinfo
bcli getrawmempool
```

Expected results:
```
{
  "loaded": true,
  "size": 2,
  "bytes": 282,
  "usage": 2416,
  "total_fee": 0.00002820,
  "maxmempool": 300000000,
  "mempoolminfee": 0.00001000,
  "minrelaytxfee": 0.00001000,
  "incrementalrelayfee": 0.00001000,
  "unbroadcastcount": 2,
  "fullrbf": false
}
...[
  "2fdc4aa2755f29d4ba8104f31e488b3e5df814a360ddb0b97ebc273a125a5971",
  "28b8215819e7bc428787fc5e71c3927e20ad13c1a60d79ee1a409acded6efda3"
]
```

Save the mempool to `mempool.dat` in the new v2 format.
Verify that `mempool.dat` has been modified, and is in the new v2 format.
```shell
bcli savemempool
ls --full-time $DATA_DIR/regtest/mempool.dat
hexdump -n8 $DATA_DIR/regtest/mempool.dat
```

Expected results:
```shell
{
  "filename": "/tmp/27-rc-test/regtest/mempool.dat"
}
...
-rw------- 1 dev dev 567 2024-03-17 18:19:48.700777882 -0400 /tmp/27-rc-test/regtest/mempool.dat
...
0000000 0002 0000 0000 0000                    
0000008
```

Stop the node and verify successful loading of the new v2 format.
Verify that the mempool contains the same two transactions created earlier.
```shell
bcli stop
bitcoind-test -daemon
bcli getmempoolinfo
bcli getrawmempool
```

Once the test is successful, don't forget to [stop your node and clean the datadir](#4-reset-testing-environment).

## v2 Transport on by Default

Bitcoin Core 27.0 enables v2 P2P Transport [by default](https://github.com/bitcoin/bitcoin/pull/29347)
for automatic connection and for `bitcoind` and `bitcoin-cli` command line flags and RPC
commands.

### Testing manual connections

For the following manual v2 connection tests, we will want to connect to signet nodes
that support V2 transport. Two such nodes that we will use in the examples below are:

**FIXME: get more addresses for this list, the second address does not do v2 AFAICT.**
- `bitcoin.achow101.com:38333`
- `175.45.182.145:38333`

Before the following tests, let's add signet=1 the bitcoin.conf to use the signet network
for testing, and turn off DNS seeds and fixed seeds so that we have more control over who
we connect to. We will also use `debug=net` to enable logging of `BCLOG::NET` messages.

``` bash
{
echo "signet=1"
echo "dnsseed=0"
echo "fixedseeds=0"
echo "debug=net"
} > $DATA_DIR/bitcoin.conf
```

#### Seeding from a V2 connection

First, let's try using a v2 seednode to fill up our peer address book (`addrman`):

``` bash
bitcoind-test -daemon -seednode=bitcoin.achow101.com:38333
```

After ~30 seconds, we can run `bitcoin-cli` with the `-netinfo` flag to make sure our node
has succeeded in bootstrapping its connection from the seed node. `-netinfo` takes an
optional integer between `0` and `4` that controls what information is output. We can use
values higher than `0` to see the transport versions of our connections in the `v` column.

> ☝ We can also use the `getpeerinfo` command to see the status of our node's connectios.

<details>

<summary>

```bash
bcli -netinfo 3
```

</summary>

```console
Bitcoin Core client v27.0rc1 - server 70016/Satoshi:27.99.0/

<->   type   net  v  mping   ping send recv  txn  blk  hb addrp addrl  age id version
out  block  ipv4  1     20    131    2    2    *    0         .          6 13 70016/Satoshi:25.0.0/
out   full  ipv4  1     43    669    0    0         0      1007          6  4 70016/Satoshi:25.0.0/
out   full  ipv4  1     51    649    0    0         0      1003          6  5 70016/Satoshi:25.0.0/
out   full  ipv4  1     58     58   35   46                1004          6  6 70016/Satoshi:22.0.0(FutureBit-Apollo-Node)/
out  block  ipv4  1    101    101    5    4    *    0         .          5 15 70016/Satoshi:24.0.1/
out   full  ipv4  1    103    420    0    0         0      1006          6  1 70015/Satoshi:0.20.1/
out   full  ipv4  1    110    634    0    0         0      1003          5 19 70016/Satoshi:26.0.0/
out   full  ipv4  1    161    164    0    0         0      1008          6 11 70016/Satoshi:23.0.0/
out   full  ipv4  1    200    382    0    0         0      1003          3 21 70016/Satoshi:25.1.0/
out   full  ipv4  1    248   6699    0    0         0      1005          6 12 70016/Satoshi:26.0.0/
                        ms     ms  sec  sec  min  min                  min

         ipv4    ipv6   total   block
in          0       0       0
out        10       0      10       2
total      10       0      10

Local addresses: n/a
```

</details>


To ensure that you have successfully made an `addrfetch` connection to the seed node using
v2 Transport, you can view logs related to `v2` and `peer=0` with the following:

<details> 

<summary>

```bash
cat $DATA_DIR/signet/debug.log | grep "v2\|peer=0"
```

</summary>

```console
2024-03-16T17:15:05Z Bitcoin Core version v27.0rc1 (release build)
2024-03-16T17:15:05Z [net] trying v2 connection bitcoin.achow101.com:38333 lastseen=0.0hrs
2024-03-16T17:15:05Z [net] Added connection peer=0
2024-03-16T17:15:05Z [net] sending version (102 bytes) peer=0
2024-03-16T17:15:05Z [net] send version message: version 70016, blocks=0, txrelay=1, peer=0
2024-03-16T17:15:05Z [net] start sending v2 handshake to peer=0
2024-03-16T17:15:05Z [net] received: version (103 bytes) peer=0
2024-03-16T17:15:05Z [net] sending wtxidrelay (0 bytes) peer=0
2024-03-16T17:15:05Z [net] sending sendaddrv2 (0 bytes) peer=0
2024-03-16T17:15:05Z [net] sending verack (0 bytes) peer=0
2024-03-16T17:15:05Z [net] sending getaddr (0 bytes) peer=0
2024-03-16T17:15:05Z [net] receive version message: /Satoshi:27.99.0/: version 70016, blocks=187042, us=76.151.248.21:49556, txrelay=1, peer=0
2024-03-16T17:15:05Z [net] received: wtxidrelay (0 bytes) peer=0
2024-03-16T17:15:05Z [net] received: sendaddrv2 (0 bytes) peer=0
2024-03-16T17:15:05Z [net] received: verack (0 bytes) peer=0
2024-03-16T17:15:05Z New addr-fetch v2 peer connected: version: 70016, blocks=187042, peer=0
2024-03-16T17:15:05Z [net] sending sendcmpct (9 bytes) peer=0
2024-03-16T17:15:05Z [net] sending ping (8 bytes) peer=0
2024-03-16T17:15:05Z [net] sending feefilter (8 bytes) peer=0
2024-03-16T17:15:05Z [net] received: sendcmpct (9 bytes) peer=0
2024-03-16T17:15:05Z [net] received: ping (8 bytes) peer=0
2024-03-16T17:15:05Z [net] sending pong (8 bytes) peer=0
2024-03-16T17:15:05Z [net] received: getheaders (965 bytes) peer=0
2024-03-16T17:15:05Z [net] Ignoring getheaders from peer=0 because active chain has too little work; sending empty response
2024-03-16T17:15:05Z [net] sending headers (1 bytes) peer=0
2024-03-16T17:15:05Z [net] received: feefilter (8 bytes) peer=0
2024-03-16T17:15:05Z [net] received: feefilter of 0.00001000 BTC/kvB from peer=0
2024-03-16T17:15:05Z [net] received: addrv2 (19582 bytes) peer=0
2024-03-16T17:15:05Z [net] Received addr: 999 addresses (999 processed, 0 rate-limited) from peer=0
2024-03-16T17:15:05Z [net] addrfetch connection completed peer=0; disconnecting
2024-03-16T17:15:06Z [net] disconnecting peer=0
2024-03-16T17:15:06Z [net] Cleared nodestate for peer=0
```

</details>

Some lines of note in the output from `debug.log`:

- `trying v2 connection <peer host or ip>:38333`: We attempted to initiate the connection
  over v2.

- `New addr-fetch v2 peer connected // [...] peer=0`: The v2 peer handshake has succeeded
  and we have connected to the seed node as an `addr-fetch` peer.

- `Received addr: <number of addresses> from peer=0`: Our addrfetch peer has sent us an
  `ADDR` or `ADDRV2` message and we've processed it and are about to store <number of
  addresses> in our `addrman`.

- `addrfetch connection complete peer=0`: We've stored the addresses we've received in our
  `addrman` and are now disconnecting from the `seednode`

#### Adding a peer manually

Now let's try to add a manual connection to a v2 capable peer and make sure that Bitcoin
Core succesfully makes a v2 connection to them.

> ☝ We can probably reuse the address or hostname we used as our `-seednode` since addrfetch
> connections are terminated once they've given us enough peers. If you decide to reuse the
> same v2 peer that you seeded from, use `getpeerinfo` to make sure they are not one of our
> curent connections, and if they are, use `disconnectnode` to drop them.

```bash
bcli addnode 175.45.182.145:38333 add
```

Check that our manual `addnode` connection succeeded with `getaddednodeinfo`:

<details>

<summary>

```bash
bcli getaddednodeinfo
```

</summary>

```json5
[
  {
    "addednode": "175.45.182.145:38333",
    "connected": true,
    "addresses": [
      {
        "address": "175.45.182.145:38333",
        "connected": "outbound"
      }
    ]
  }
]
```

</details>

Now verify that your connection to the added node is a v2 connection using `getpeerinfo`.

<details>

<summary>

```bash
bcli getpeerinfo
```

</summary>

```json5
{
    "id": 18,
    "addr": "<hostname/ip>:38333",
    "servicesnames": [
      "NETWORK",
      "WITNESS",
      "COMPACT_FILTERS",
      "NETWORK_LIMITED",
      "P2P_V2"
    ],

    // [...]

    "connection_type": "manual",
    "transport_protocol_type": "v2",
    "session_id": "92e0c037b75edf14d0e85032f5aedc8ff450e1b708bd03ceee38eef065dd5e87"
  },
```

</details>

Once the test is successful, don't forget to [stop your node and clean the datadir](#4-reset-testing-environment).

If you are interested in learning more about v2 Transport, we encourage you to read
[BIP324](https://github.com/bitcoin/bips/blob/master/bip-0324.mediawiki) and the [BIP324
tracking issue](https://github.com/bitcoin/bitcoin/issues/27634).

## netinfo backward compatibility with pre-v26 nodes
`-netinfo` capability of a newer (e.g. v26) RPC client (bitcoin-cli) was broken when communicating with an older node (e.g. v25).  This PR fixes this, and displays "v1" for the transport protocol used in the `-netinfo` output.

Start a v25 node:
```bash
bitcoind-test-25 -daemon
```
Start a v27 node:
```bash
bitcoind-test -daemon
```

Connect the two nodes:
```bash
bcli addnode 127.0.0.1:18244 add
```

Run `netinfo` with the v27 RPC client calling the v27 node.
Verify that the `v` column (transport version) is `1` (since this is a v1 connection).
```bash
bcli -netinfo 4
```

Run `netinfo` with the v27 RPC client calling the v25 node.
Verify that the `v` column (transport version) is `1` (since this is a v1 connection).
```bash
bcli -conf=$DATA_DIR_25/bitcoin.conf -rpccookiefile=$DATA_DIR_25/regtest/.cookie -netinfo 4
```

Once the test is successful, don't forget to [stop your node and clean the datadir](#4-reset-testing-environment).

## v3 Transaction Policy

**FIXME: See https://github.com/bitcoin/bitcoin/blob/master/test/functional/mempool_accept_v3.py for test ideas.**

## CoinGrinder coin selection algorithm

## `migratewallet` RPC is no longer experimental

***

Kudos if you make it this far 👏🎉

Thanks for your contribution and for taking the time to make Bitcoin awesome. For feedback on this guide, please visit [TBD ISSUE NUM](https://github.com/bitcoin/bitcoin/issues/NUMBER)

***

Many thanks to [USER](https://github.com/USER) for their input and review on this document.
